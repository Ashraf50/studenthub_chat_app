<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Øª - Socket.io</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <h2>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Øª - Ø±ÙŠØ§Ù„ ØªØ§ÙŠÙ…</h2>
    <label for="userId">Ù…Ø¹Ø±Ù‘ÙÙƒ (ID):</label>
    <input type="text" id="userId" placeholder="Ø§Ø¯Ø®Ù„ ID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ" disabled />
    <label for="receiverId">Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ (ID):</label>
    <input type="text" id="receiverId" placeholder="Ø§Ø¯Ø®Ù„ ID Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„" />
    <br><br>
    <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." />
    <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
    <h3>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„:</h3>
    <ul id="messages"></ul>
    <script>
        const socket = io("https://chat120-abb88025e3e2.herokuapp.com/");
        let userId = prompt("Ø§Ø¯Ø®Ù„ Ø§Ù„Ù€ ID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:");
        if (!userId) {
            alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ID Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©!");
            location.reload();
        } else {
            document.getElementById("userId").value = userId;
            socket.emit("join", userId);
        }
        socket.on("connect", () => {
            console.log("âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±");
        });
        socket.on("receiveMessage", (data) => {
            console.log("ğŸ“© Ø±Ø³Ø§Ù„Ø© Ù…Ø³ØªÙ„Ù…Ø©:", data);

            const messageList = document.getElementById("messages");
            const newMessage = document.createElement("li");
            newMessage.textContent = `${data.senderId} -> ${data.recipientId}: ${data.message}`;
            messageList.appendChild(newMessage);
        });
        function sendMessage() {
            const receiverId = document.getElementById("receiverId").value.trim();
            const message = document.getElementById("messageInput").value.trim();
            if (!userId || !receiverId || !message) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù€ ID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ùˆ Ø§Ù„Ù€ ID Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ø±Ø³Ø§Ù„Ø©!");
                return;
            }
            console.log("ğŸš€ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©:", { senderId: userId, recipientId: receiverId, message });
            socket.emit("sendMessage", {
                senderId: userId,
                recipientId: receiverId,
                message: message
            });
            document.getElementById("messageInput").value = "";    
        }
    </script>
</body>
</html>
